<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ЁЯОЙ рд╢реБрдн рджреАрдкрд╛рд╡рд▓реА рд╡рд┐рд╢рд┐рдВрдЧ рдкреЗрдЬ ЁЯОЙ</title>

<style>
body {
  margin: 0;
  padding: 0;
  background: linear-gradient(180deg, #ffb347, #ffcc33);
  font-family: 'Poppins', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  color: #fff;
  text-align: center;
}

#uiCard {
  background: rgba(255,255,255,0.1);
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  backdrop-filter: blur(10px);
  width: 90%;
  max-width: 400px;
}

input {
  padding: 10px;
  border: none;
  border-radius: 10px;
  width: 80%;
  text-align: center;
  font-size: 1.1em;
}

button {
  margin-top: 15px;
  background: #ff6f00;
  color: #fff;
  border: none;
  border-radius: 10px;
  padding: 10px 20px;
  cursor: pointer;
  font-size: 1.1em;
  transition: 0.3s;
}

button:hover {
  background: #e65100;
}

.hidden { display: none; }

#wishNameEl {
  font-size: 1.5em;
  font-weight: bold;
  text-shadow: 2px 2px 5px #000;
  animation: pop 1s ease;
}

@keyframes pop {
  0% { transform: scale(0); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

#wishMessageEl {
  margin-top: 15px;
  font-size: 1.1em;
  line-height: 1.5;
}

#shareUrlBlock {
  margin-top: 15px;
  background: #43a047;
  border-radius: 10px;
  padding: 10px;
}

#shareUrlBlock a {
  color: #fff;
  text-decoration: none;
  font-weight: bold;
}
</style>
</head>

<body>

<div id="uiCard">
  <h2>тЬи рдЕрдкрдирд╛ рдирд╛рдо рдбрд╛рд▓реЗрдВ рдФрд░ рджреАрдкрд╛рд╡рд▓реА рд╡рд┐рд╢ рдмрдирд╛рдПрдВ тЬи</h2>

  <div id="inputArea">
    <input id="nameInput" type="text" placeholder="рдЕрдкрдирд╛ рдирд╛рдо рд▓рд┐рдЦреЗрдВ">
    <button id="generateBtn">ЁЯОЗ рд╡рд┐рд╢ рдмрдирд╛рдПрдВ</button>
  </div>

  <div id="wishTop" class="hidden">
    <div id="wishNameEl"></div>
    <div id="wishMessageEl">
      ЁЯТБтАНтЩВ рд╢реБрдн рджреАрдкрд╛рд╡рд▓реА ЁЯМЯ <br>
      рдорд╛рддрд╛ рд▓рдХреНрд╖реНрдореА рдЖрдкрдХреЗ рдШрд░ рдореЗрдВ рд╕реЛрдирд╛, рдЪрд╛рдВрджреА рдФрд░ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд▓реЗрдХрд░ рдЖрдПрдБ!<br>
      ЁЯЩПЁЯкФрд╢реБрдн рджреАрдкрд╛рд╡рд▓реАредЁЯкФЁЯЩП
    </div>
  </div>

  <div id="afterArea" class="hidden">
    <button id="shareBtn">ЁЯФЧ Share Wish (Image + Link)</button>
    <div id="shareUrlBlock" class="hidden"></div>
    <div id="rewardNote" style="display:none;margin-top:10px;color:#ffee58;">
      тЬЕ Reward Earned: +10 points
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
const nameInput = document.getElementById('nameInput');
const generateBtn = document.getElementById('generateBtn');
const wishTop = document.getElementById('wishTop');
const wishNameEl = document.getElementById('wishNameEl');
const wishMessageEl = document.getElementById('wishMessageEl');
const afterArea = document.getElementById('afterArea');
const shareBtn = document.getElementById('shareBtn');
const shareUrlBlock = document.getElementById('shareUrlBlock');
const rewardNote = document.getElementById('rewardNote');
const inputArea = document.getElementById('inputArea');

/* ----------- Generate Wish ---------- */
function makeShareableUrl(namePlain){
  const base = window.location.href.split('?')[0];
  return `${base}?name=${encodeURIComponent(namePlain)}`;
}

function showSharedWish(name){
  wishNameEl.textContent = `ЁЯТБтАНтЩВ ${name} рдХреА рдУрд░ рд╕реЗ рд╢реБрдн рджреАрдкрд╛рд╡рд▓реА ЁЯМЯ`;
  wishTop.classList.remove('hidden');
  inputArea.style.display = 'none';
  afterArea.classList.remove('hidden');

  // рдХреНрд▓рд┐рдХреЗрдмрд▓ рд▓рд┐рдВрдХ
  const url = makeShareableUrl(name);
  shareUrlBlock.innerHTML = `<a href="${url}" target="_blank">ЁЯФЧ Open Shared Wish</a>`;
  shareUrlBlock.classList.remove('hidden');
}

window.addEventListener('load', () => {
  const p = new URLSearchParams(window.location.search);
  const sharedName = p.get('name');
  if(sharedName){
    showSharedWish(sharedName);
  }
});

generateBtn.addEventListener('click', () => {
  const nm = nameInput.value.trim();
  if(!nm){ alert('рдХреГрдкрдпрд╛ рдЕрдкрдирд╛ рдирд╛рдо рд▓рд┐рдЦреЗрдВ'); nameInput.focus(); return; }
  showSharedWish(nm);
});

/* ---------- WhatsApp Share + Image Upload ---------- */
async function shareWish(){
  shareBtn.disabled = true;
  shareBtn.textContent = 'Preparing...';
  try{
    const canvas = await html2canvas(document.getElementById('uiCard'));
    const blob = await new Promise(res => canvas.toBlob(res,'image/png'));

    const clientId = 'YOUR_IMGUR_CLIENT_ID'; // рдпрд╣рд╛рдБ рдЕрдкрдиреА Imgur Client-ID рдбрд╛рд▓реЗрдВ
    const formData = new FormData();
    formData.append('image', blob);

    const resp = await fetch('https://api.imgur.com/3/image', {
      method: 'POST',
      headers: { Authorization: `Client-ID ${clientId}` },
      body: formData
    });

    const data = await resp.json();
    if(!data.success) throw new Error('Upload failed');

    const imageUrl = data.data.link;
    const nameText = wishNameEl.textContent;
    const wishText = wishMessageEl.innerText;
    const waText = encodeURIComponent(`${nameText}\n${wishText}\n\n${imageUrl}`);
    const waUrl = `https://wa.me/?text=${waText}`;

    window.open(waUrl,'_blank');
    rewardNote.style.display = 'block';
    setTimeout(()=>rewardNote.style.display='none',3000);
  }catch(e){
    console.error(e);
    alert('Share failed, check console');
  }finally{
    shareBtn.disabled = false;
    shareBtn.textContent = 'ЁЯФЧ Share Wish (Image + Link)';
  }
}
shareBtn.addEventListener('click', shareWish);
</script>

</body>
</html>
